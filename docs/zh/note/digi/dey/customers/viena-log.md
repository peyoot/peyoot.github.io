# vienaPLC设备接口同DVK区别

#### HDMI接口相关 
1、DSI_RST 原开发板用pd7， vienaPLC用SPI3_MOSI，即PB8， 对应驱动要调整，但刚好板子只用MIPI转的信号，不需要MIPI DSI接口，所以不用改


## TSC2046驱动调优日志

1、确定了vref-mv才是内外参考源的控制参数
2、确定了keep-vrefon会出轮询数据 ，只用中断数据比较难出
3、有无滤波电容对参数影响巨大
4、SPI可用，模式极性是对的，所以片选也不用翻转，01r


### 寄到上海的产品初测：
![alt text](1dc0e7c9-0ee2-46f5-b35f-669b845a417e.png)

X面板电阻：1，3引脚： 695
Y面板电阻：2, 4引脚： 235

由于串接10ohm电阻，相应的X面板测得705，Y面板245，但实测X715, Y255

Y方向，测X+同Y+之间的电阻值: 未触碰时5.3M欧，相当于断路，一旦按下：
右上到右下角方向：
在右上角测得最小值在750欧左右，相当于接近X面板电阻。 须注意，离电极3mm内是无效的（即很难触碰出数据），所以触碰按钮不可放在这一区域。
右下角：520欧 左右

左上角到左下角方向
左上角：1400欧，同样，需离电极保持3mm以上的距离
左下角：1230区左右

触碰范围尺寸，即X，Y电极包裹的内尺寸为：225.32 X 127.88 mm， 但根据上面实测，各要减6mm，因此实际有效尺寸为219 x 121mm
LVDS液晶屏尺寸: 222.72 x 125.28

为了保证线性，建议在触屏有效尺寸之外不放触控键。


欧洲研发报告（拟）：
1、Linux主线驱动调整：
针对ADS7846驱动，从内核6.6 (代码：1411行)到6.18(代码：1438行)
ads7846.c 驱动有少许渐进式改进，主要聚焦于兼容性、错误处理和资源管理，而不是重大重构。
Raspberry Pi bookworm社区报告v6.6 有 IRQ/pendown 问题，这可能在 v6.18 通过 genirq 和 spi-fix merge解决，但内核的 input 子系统有更新，也许不可以直接用最新主线内核驱动，而应聚集于Raspberry的补丁。
1. 6.6~6.18间，哪个版本有子系统更新，在没有更新之前，最新内核应可用。
2. Raspberry社区中的相关资源：
https://github.com/raspberrypi/linux/tree/rpi-6.6.y

Raspberry Pi 上 TSC2046 (或兼容的 XPT2046) 触控芯片的最新设备树参考主要通过 Device Tree Overlay (DTO) 来配置，而不是完整的 DTS 文件。这在官方 Raspberry Pi 论坛的 2025 年帖子中被确认，使用内置的 piscreen overlay，支持 3.5" TFT LCD (480x320) 和 XPT2046 触控控制器，无需额外驱动安装。 这适用于 Raspberry Pi OS Bookworm (基于较新内核，如 v6.x 系列)，并在 Raspberry Pi 3B 上验证过。


